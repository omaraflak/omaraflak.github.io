<link rel="stylesheet" href="/assets/hct/hct.css">

<div class="container">
    <div id="chroma-input-container">
        <label for="chromaSlider">Chroma:</label>
        <input type="range" id="chromaSlider" min="0" max="150" value="150" step="1" />
        <span id="chromaValue">150</span>
    </div>
    <div id="grid"></div>
</div>

<script type="module">
    import { Hct } from 'https://cdn.jsdelivr.net/npm/@material/material-color-utilities@0.3.0/index.min.js';

    const chromaSlider = document.getElementById('chromaSlider');
    const chromaValue = document.getElementById('chromaValue');
    const grid = document.getElementById('grid');

    function makeTooltip(color) {
        const tooltip = document.createElement('div');
        tooltip.id = "tooltip-container"

        const span = document.createElement('span')
        span.id = 'tooltip-text'
        span.innerText = color

        tooltip.appendChild(span)
        return tooltip
    }

    function makeTooltipCopy() {
        const tooltip = document.createElement('div');
        tooltip.id = "tooltip-copy-container"

        const span = document.createElement('span')
        span.id = 'tooltip-copy-text'
        span.innerText = 'Copied! âœ…'

        tooltip.appendChild(span)
        return tooltip
    }

    function renderGrid(chroma) {
        grid.innerHTML = '';
        for (let hue = 0; hue <= 360; hue += 5) {
            const row = document.createElement('div');
            row.id = 'row';
            for (let tone = 0; tone <= 100; tone += 5) {
                const hct = Hct.from(hue, chroma, tone);
                const rgb = hct.argb & 0xffffff
                const color = `#${rgb.toString(16).padStart(6, '0')}`;
                const square = document.createElement('div');
                square.id = "square";
                square.style.background = color;
                const tooltip = makeTooltip(color)
                const tooltipCopy = makeTooltipCopy()
                square.appendChild(tooltip)
                square.appendChild(tooltipCopy)
                row.appendChild(square);
                square.onclick = function () {
                    navigator.clipboard.writeText(color);
                    tooltipCopy.style.visibility = 'visible'
                    setTimeout(() => {
                        tooltipCopy.style.visibility = 'hidden'
                    }, 1000)
                };
            }
            grid.appendChild(row);
        }
    }

    chromaSlider.addEventListener('input', () => {
        chromaValue.textContent = chromaSlider.value;
        renderGrid(Number(chromaSlider.value));
    });

    chromaValue.textContent = chromaSlider.value;
    renderGrid(Number(chromaSlider.value));
</script>