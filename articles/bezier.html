<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Bézier Curve">
    <meta property="og:description" content="Understand the mathematics of Bézier curves.">
    <title>Bézier Curve</title>
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg">
    <link rel="stylesheet" href="../styles/index.css">
    <link rel="stylesheet" href="../styles/fonts.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/github.min.css" integrity="sha512-0aPQyyeZrWj9sCA46UlmWgKOP0mUipLQ6OZXu8l4IcAmD2u31EPEy9VcIMvl7SoAaKe8bLXZhYoMaE/in+gcgA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <div class="site-header">
        <div class="site-header-content">
            <a href="/index.html" class="site-header-link">Home</a>
            <a href="/articles.html" class="site-header-link">Blog</a>
        </div>
    </div>
    <div class="article-header">
        <div class="article-header-content">
            <h1 class="article-title">Bézier Curve</h1>
            <p class="article-description">Understand the mathematics of Bézier curves.</p>
            <p class="article-date">May 02, 2020</p>
            
        </div>
    </div>
    <main class="article-main">
        <article class="article-body">
            <p>Bézier curves are used extensively in computer graphics, often to produce smooth curves. If you have ever used Photoshop you might have stumbled upon that tool called "Anchor" where you can put anchor points and draw some curves with them... These are Bézier curves. Or if you have used vector-based graphic, SVG, these too use Bézier curves. Let's see how it works.</p>
<h2 id=general-definition class="article-section">General Definition</h2>
<p>Given [begin-latex-inline]n+1[end-latex-inline] points [begin-latex-inline]\{P_0, ..., P_n\}[end-latex-inline] called the <span class="article-bold"><span class="article-italic">control points</span></span>, the <a class="article-link" target="_blank" href="https://en.wikipedia.org/wiki/B%C3%A9zier_curve">Bézier curve</a> traced by these points is defined as:</p>
<div class="article-latex">[begin-latex]\begin{align}
Z(t) = \sum_{i=0}^n B_i^n(t) \cdot P_i, \quad t \in[0, 1]
\end{align}[end-latex]</div>
<p>Where [begin-latex-inline]P_i=\{x_i, y_i\}[end-latex-inline], and [begin-latex-inline]B_i^n(t)[end-latex-inline] is the <a class="article-link" target="_blank" href="https://en.wikipedia.org/wiki/Bernstein_polynomial">Bernstein polynomial</a>:</p>
<div class="article-latex">[begin-latex]B_i^n(t) = {n \choose i} t^i (1-t)^{n-i}, \quad {n \choose i} = \frac{n!}{i! (n-i)!}[end-latex]</div>
<div class="article-quote">Note that [begin-latex-inline]Z(t)[end-latex-inline] is not a number, but a point!</div>
<p>Notice that Bernstein polynomial looks a lot like the [begin-latex-inline]k^{\text{th}}[end-latex-inline] term in Newton's binomial formula:</p>
<div class="article-latex">[begin-latex](a+b)^n = \sum_{i=0}^n {n \choose i} a^i b^{n-1}[end-latex]</div>
<p>For the particular values of [begin-latex-inline]a=1[end-latex-inline] and [begin-latex-inline]b=t-1[end-latex-inline]. It then becomes obvious that:</p>
<div class="article-latex">[begin-latex]\sum_{i=0}^n B_i^n(t) = 1[end-latex]</div>
<p>Therefore, you can interpret [begin-latex-inline]Z(t)[end-latex-inline] as a weighted average of the control points. As [begin-latex-inline]t[end-latex-inline] changes, the weighted average [begin-latex-inline]Z(t)[end-latex-inline] smoothly moves from the <span class="article-bold">first</span> control point to the <span class="article-bold">last</span> control point. Indeed:</p>
<div class="article-latex">[begin-latex]\begin{align*}
Z(0) &= \sum_{i=0}^n B_i^n(0) \cdot P_i \\
&= P_0
\end{align*}[end-latex]</div>
<p>That is because:</p>
<div class="article-latex">[begin-latex]B_i^n(0) =
\left\{
\begin{array}{ll}
1 \quad \text{if} \quad i = 0 \\
0 \quad \text{if} \quad i \neq 0
\end{array}
\right.[end-latex]</div>
<p>Similarily:</p>
<div class="article-latex">[begin-latex]\begin{align*}
Z(n) &= \sum_{i=0}^n B_i^n(n) \cdot P_i \\
&= P_n
\end{align*}[end-latex]</div>
<h2 id=quadratic-bezier-curve class="article-section">Quadratic Bézier Curve</h2>
<p>The quadratic Bézier curve is how we call the Bézier curve with 3 control points, since the degree of [begin-latex-inline]Z(t)[end-latex-inline] will be 2. Let's calculate the Bézier curve given 3 control points and explore some properties we might find! Remember, [begin-latex-inline](1)[end-latex-inline] holds for [begin-latex-inline]n+1[end-latex-inline] points, so in our case [begin-latex-inline]n=2[end-latex-inline].</p>
<div class="article-latex">[begin-latex]\begin{align*}
Z(t) &= \sum_{i=0}^2 B_i^2(t) \cdot P_i \\
&= \sum_{i=0}^2 {2 \choose i} t^i (1 - t)^{2-i} \cdot P_i \\
&= {2 \choose 0} t^0 (1 - t)^{2-0} \cdot P_0 + {2 \choose 1} t^1 (1 - t)^{2-1} \cdot P_1 + {2 \choose 2} t^2 (1 - t)^{2-2} \cdot P_2 \\
&= (1-t)^2 \cdot P_0 + 2t(1-t) \cdot P_1 + t^2 \cdot P_2
\end{align*}[end-latex]</div>
<p>Now we just have to choose three control points and evaluate the curve on the range [begin-latex-inline][0, 1][end-latex-inline]. We can do this in Python easily.</p>
<pre class="article-code-block python"><code>import numpy as np
import matplotlib.pyplot as plt

P0, P1, P2 = np.array([
	[0, 0],
	[2, 4],
	[5, 3]
])

# define bezier curve
Z = lambda t: (1 - t)**2 * P0 + 2 * t * (1 - t) * P1 + t**2 * P2

# evaluate the curve on [0, 1] sliced in 50 points
points = np.array([Z(t) for t in np.linspace(0, 1, 50)])

# get x and y coordinates of points separately
x, y = points[:,0], points[:,1]

# plot
plt.plot(x, y, 'b-')
plt.plot(*P0, 'r.')
plt.plot(*P1, 'r.')
plt.plot(*P2, 'r.')
plt.show()</code></pre>
<center><img class="article-image" height="" width="80%" src="/assets/bezier/bezier_1.webp" alt="bezier"></center>
<p>Notice that the curve does indeed start and end at the first and last control points. Because of that, if you fix [begin-latex-inline]P_0[end-latex-inline] and [begin-latex-inline]P_2[end-latex-inline], the [begin-latex-inline]P1[end-latex-inline] entirely determines the shape of the curve. Moving [begin-latex-inline]P1[end-latex-inline] around you might notice something:</p>
<center><img class="article-image" height="" width="100%" src="/assets/bezier/bezier_2.webp" alt="bezier different P1"></center>
<p>The Bézier curve is always contained in the polygon formed by the control points. This polygon is hence called the control polygon, or Bézier polygon. This property also holds for any number of control points, which makes their manipulation quite intuitive when using a software.</p>
<center><img class="article-image" height="" width="100%" src="/assets/bezier/bezier_3.webp" alt="bezier curve is contained in convex hull"></center>
<h3 id=matrix-representation class="article-small-section">Matrix Representation</h3>
<p>We can actually represent the Bézier formula using matrix multiplication, which might be useful in other contexts, for instance for splitting the Bézier curve. If we go back to our example we can rewrite [begin-latex-inline]Z(t)[end-latex-inline] as follows:</p>
<div class="article-latex">[begin-latex]\begin{align*}
Z(t) &= (1-t)^2 \cdot P_0 + 2t(1-t) \cdot P_1 + t^2 \cdot P_2 \\
&= (1-2t+t^2) \cdot P_0 + (2t-2t^2) \cdot P_1 + t^2 \cdot P_2 \\
&= \begin{bmatrix} (1-2t+t^2) & (2t-2t^2) & t^2 \end{bmatrix} \cdot \begin{bmatrix} P_0 \\ P_1 \\ P_2 \end{bmatrix}  \\
&= \begin{bmatrix} 1 & t & t^2 \end{bmatrix} \cdot \begin{bmatrix} 1 & 0 & 0 \\ -2 & 2 & 0 \\ 1 & -2 & 1 \end{bmatrix} \cdot \begin{bmatrix} P_0 \\ P_1 \\ P_2 \end{bmatrix}  \\
&= T \cdot M \cdot P
\end{align*}[end-latex]</div>
<p>All the information of the quadratic Bézier curve is now compacted into one matrix, [begin-latex-inline]M[end-latex-inline]. Notice the [begin-latex-inline]i^{\text{th}}[end-latex-inline] column of [begin-latex-inline]M[end-latex-inline] is just the coefficients of the polynomial [begin-latex-inline]B_i^n[end-latex-inline]. However, if we want to program this, it will be easier to create a matrix row by row, instead of column by column. Luckily, because [begin-latex-inline]{n \choose i} = {n \choose n-i}[end-latex-inline], the [begin-latex-inline]i^{\text{th}}[end-latex-inline] row of the matrix is just the reversed [begin-latex-inline](n-i)^{\text{th}}[end-latex-inline] column.</p>
<div class="article-latex">[begin-latex]\begin{align*}
Z(t) &= {n \choose n-i} t^{n-i} (1 - t)^{n-(n-i)} \\
&= {n \choose i} t^{n-i} (1 - t)^i \\
&= {n \choose i} t^{n-i} \sum_{k=0}^i {i \choose k} 1^k (-t)^{i-k} \\
&= {n \choose i} t^{n-i} \sum_{k=0}^i {i \choose k} (-1)^{i-k} t^{i-k} \\
&= \sum_{k=0}^i {n \choose i} {i \choose k} (-1)^{i-k} t^{n-k}
\end{align*}[end-latex]</div>
<p>Therefore, the coefficients of the matrix are nothing but the coefficients of [begin-latex-inline]t[end-latex-inline]:</p>
<div class="article-latex">[begin-latex]{n \choose i} {i \choose k} (-1)^{i-k}, \quad \left\{
\begin{array}{ll}
i = 0, ..., n \\
k = 0, ..., i
\end{array}
\right.[end-latex]</div>
<pre class="article-code-block python"><code>from math import comb

def get_bezier_matrix(n: int) -> list[list[float]]:
    coef = [[0] * (n + 1) for _ in range(n + 1)]
    for i in range(n + 1):
        for k in range(i + 1):
            coef[i][k] = comb(n, i) * comb(i, k) * (-1)**(i - k)
    return coef</code></pre>
<div class="article-hr"></div>
<p>Lastly, this is a general version of the polynomial version:</p>
<pre class="article-code-block python"><code>import numpy as np
import matplotlib.pyplot as plt
from math import comb

def get_bezier_curve(points):
    n = len(points) - 1
    return lambda t: sum(
        comb(n, i) * t**i * (1 - t)**(n - i) * points[i]
        for i in range(n + 1)
    )

def evaluate_bezier(points, total):
    bezier = get_bezier_curve(points)
    new_points = np.array([bezier(t) for t in np.linspace(0, 1, total)])
    return new_points[:,0], new_points[:,1]

points = np.array([
    [0, 0],
    [-1, 3],
    [4, 3],
    [6, 0],
    [7, 2.5]
])

x, y = points[:,0], points[:,1]
bx, by = evaluate_bezier(points, 50)
plt.plot(bx, by, 'b-')
plt.plot(x, y, 'r.')
plt.show()</code></pre>
        </article>
    </main>
    <div class="article-hr"></div>
    <div class="site-footer">
        <div class="site-footer-content"></div>
    </div>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js" integrity="sha512-LQNxIMR5rXv7o+b1l8+N1EZMfhG7iFZ9HhnbJkTp4zjNr5Wvst75AqUeFDxeRUa7l5vEDyUiAip//r+EFLLCyA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js" integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous" referrerpolicy="no-referrer" onload="renderMathInElement(document.body, {
        delimiters: [
            {left: '[begin-latex]', right: '[end-latex]', display: true},
            {left: '[begin-latex-inline]', right: '[end-latex-inline]', display: false},
        ]
    });"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js" integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw==" crossorigin="anonymous" referrerpolicy="no-referrer" onload="hljs.highlightAll();"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js" integrity="sha512-vnRdmX8ZxbU+IhA2gLhZqXkX1neJISG10xy0iP0WauuClu3AIMknxyDjYHEpEhi8fTZPyOCWgqUCnEafDB/jVQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/lite.render.js" integrity="sha512-uAHj1knkgGpl0fJcyjbcVY0f9j252eWzEeBxE4s4AQkPJkp/+U+rlfoOXlwreSzPhndCT+5YR00/QSD/nPqb+g==" crossorigin="anonymous" referrerpolicy="no-referrer" onload="
        const viz = new Viz();
        document.querySelectorAll('.article-graphviz').forEach(element => {
            const content = element.textContent;
            try {
                viz.renderSVGElement(content)
                    .then(svg => {
                        element.textContent = '';
                        element.appendChild(svg);
                    })
                    .catch(error => {
                        console.error('Error rendering Graphviz SVG:', error);
                        element.textContent = 'Error rendering graph. Check console for details.';
                    });
            } catch (error) {
                console.error('Error with Viz.js rendering process:', error);
                element.textContent = 'Error during graph rendering setup.';
            }
        });
    "></script>
</body>

</html>